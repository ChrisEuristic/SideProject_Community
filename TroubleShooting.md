# AWS Lightsail에서의 Node 서버와 MySQL 마이그레이션 문제 상황 및 해결 방안

### 1. 문제 상황

AWS Lightsail에 Node 서버를 마이그레이션하고 MySQL을 설치하여 데이터베이스를 설정하였습니다. 그러나 API 테스트 중 MySQL 쿼리 결과를 받는 API가 무한 응답 상태에 빠지는 문제를 경험하였습니다. 루트는 정상적으로 응답을 받았지만, 이 특정 API 호출에서 문제가 발생하였습니다.

### 2. 해결 방안:

여러 가능성을 검토하였습니다. 경로문제, 포트문제, CORS 설정문제, 서버오류, 데이터베이스 연결 등을 검토하였고 MySQL의 추가 계정 접근 권한도 검토해보았습니다. 이들 중 어느 것도 문제의 원인이 아니었습니다. 에러 로그를 확인하는 과정에서 "존재하지 않는 테이블" 이라는 메시지를 발견하였고 이 문제를 해결하기 위해 테이블 이름의 대소문자를 바꾸어보았고, 그 결과 API가 정상적으로 호출되었습니다.

### 3. 느낀점

이번 문제 해결 과정을 통해 MySQL의 사용 환경에 따른 중요한 차이점을 알게 되었습니다. Workbench나 Windows 환경에서 Mysql을 사용할 때에는 대소문자를 가리지 않지만, Linux 환경에서는 대소문자를 구별한다는 것입니다. 이러한 사실을 알게 되어 향후 유사한 문제에 직면했을 때 빠르게 문제를 해결하는 데 도움이 될 것입니다. 이 경험은 Linux 환경에서의 MySQL 사용시 주의해야 할 점을 재조명하였습니다.

---

# 루트 레이아웃 CSR 전환으로 인한 SEO 문제에 대한 문서

### 1. 문제 상황

루트 레이아웃을 Client-Side Rendering (CSR)로 전환하면서 SEO 문제가 발생했습니다. 이 전환은 상태 관리 라이브러리인 Recoil을 도입하면서 필요했습니다. Recoil Provider가 전체 페이지와 컴포넌트를 둘러싸게 되면서 루트 레이아웃을 CSR로 처리할 수 밖에 없게 되었습니다. 이로 인해 메타데이터가 제외되면서 SEO에 문제가 발생했습니다.

### 2. 해결 방안

이 문제의 해결 방안은 루트 레이아웃을 다시 Server-Side Rendering (SSR)로 전환하고 루트 레이아웃에 구현되어 있는 부분들을 하위 레이아웃이나 페이지로 이동하는 것입니다. 이렇게 함으로써 메타데이터가 다시 포함되어 SEO 문제를 해결할 수 있습니다.

### 3. 향후 계획

이러한 수정을 통해 최종적으로 SEO 문제를 해결할 계획입니다. SSR과 CSR 간의 균형을 유지하면서 필요한 기능을 구현하고, SEO 문제를 방지하기 위한 전략을 계속해서 개발하고 적용할 예정입니다. 이는 웹사이트의 접근성 향상 및 최적의 사용자 경험 제공을 위한 중요한 작업입니다.

---

# 관리자 권한 문제와 그에 따른 대응 방안에 대한 문서

### 1. 문제 상황

Vercel에 배포 후 관리자 권한 문제가 발생했습니다. 원래는 관리자 계정으로 로그인 시 Ajax 통신을 통해 Serverless API에 유효성 검사를 요청하고, 200 OK 응답을 받으면 Recoil 변수에 관리자 인증 정보를 저장하여 권한을 부여했습니다. 그러나 루트 레이아웃이 Client-Side Rendering (CSR)에서 Server-Side Rendering (SSR)로 전환되면서, 기존의 Recoil 변수를 통한 관리자 권한 부여 방식을 사용할 수 없게 되었습니다.

### 2. 해결 방안

이 문제를 해결하기 위해 페이지를 이동할 때마다 관리자 권한 유효성을 검사하는 방식으로 바꿀 계획입니다. 이를 위해 Ajax 통신을 이용하여 Serverless Database에 관리자 권한 유효성 검사를 요청하고, 그 결과를 받아 관리자 권한을 행사하게 될 것입니다.

### 3. 향후 계획

이 변경사항을 적용함으로써 SSR 방식에서도 관리자 권한 부여가 원활하게 이루어질 것으로 예상합니다. 또한 이 방식은 관리자 권한의 유효성을 지속적으로 확인하면서 보안성을 더욱 강화하는 효과도 기대할 수 있습니다. 이러한 개선을 통해 웹 애플리케이션의 안정성과 사용자 경험을 향상시킬 계획입니다.

---

# MySQL에서 Postgres로의 데이터베이스 마이그레이션과 콜드 스타트 문제에 대한 문서

### 1. 상황 개요

기존에 MySQL을 사용하던 데이터베이스 시스템을 Postgres로 마이그레이션하였으며, 현재는 Vercel에 배포된 상태입니다. 그러나 배포 후 콜드 스타트 문제로 인해 최초 데이터 로딩 시 약 2에서 3초의 딜레이가 발생하는 문제가 있습니다.

### 2. 문제 설명

콜드 스타트는 서버리스 환경에서 흔히 발생하는 문제로, 애플리케이션이 처음 시작하거나 일정 시간 동안 사용되지 않았을 때 발생합니다. 이로 인해 애플리케이션의 응답 시간이 느려지는 현상을 말합니다. 

### 3. 해결 방안

이 문제를 해결하기 위한 명확한 해결책을 아직 찾지 못했습니다. 그러나 콜드 스타트 문제는 일반적으로 두 가지 방법으로 접근할 수 있습니다. 첫째, 애플리케이션의 시작 시간을 최소화하는 것입니다. 이는 코드 최적화, 의존성 관리 등을 통해 이루어집니다. 둘째, 콜드 스타트를 미리 발생시켜 딜레이를 줄이는 것입니다. 이는 주기적인 "웜 업" 요청을 통해 가능합니다.

### 4. 향후 계획

현재로서는 위의 두 가지 접근법을 통해 콜드 스타트 문제를 해결하는 방안을 모색하고 있습니다. 더욱 구체적인 해결책을 찾기 위해 계속적으로 연구하고 테스트할 계획입니다. 이를 통해 사용자의 초기 로딩 경험을 개선하고, 애플리케이션의 성능을 향상시키는 것이 최종 목표입니다.

> - 지속적으로 웜업 시키는 것보다 콜드스타트 딜레이를 제거한 Cloudflare workers를 사용하는게 낫다는 판단.
> - 하지만 완전 서버리스 웹 서비스가 아니라 서버를 구축할 필요가 있다면 차라리 서버리스-DB 연결을 포기하고 클라우드에 백엔드 서버를 구현하는게 낫다고 생각.
